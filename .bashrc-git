# start git shell via
# > bash --rcfile=.bashrc-git

# load completions
source /usr/share/bash-completion/completions/git


# prompt
function update_prompt {
    BRANCH=$(git branch -vv | grep ^*)
    if [[ $BRANCH =~ "(HEAD detached at" ]]; then
        BRANCH='DETACHED'
    else
        # filter name and tracking status
        BRANCH=$(echo "$BRANCH" | sed -E 's/\* (\S+)\s+\S+ \[[^:]+:?(.*)\].*/\1\2/')
    fi
    PS1="\w [$BRANCH] > "
}
PROMPT_COMMAND=update_prompt


# aliases

alias pl='git pull --ff-only'

alias s='git status'

alias a='git add --all; git status -s'

function c {
    # use function to allow unquoted message
    git commit -m "$*"
}

alias p='git push'
alias pu='git push -u origin HEAD'
alias pf='git push --force'

alias mr='git merge --no-edit'

alias co='git checkout'
__git_complete co _git_checkout

alias lo='git log --pretty=format:"%h %s (%an %ar)"'

alias b='git branch'
alias cb='git checkout -b'
alias bd='git branch -d'
__git_complete bd _git_checkout

alias rb='git rebase'

alias rh='git reset --hard'
